{%- comment %}
  Renders product media

  @param {media} media - The media object to be rendered
  @param {boolean} [preload] - Whether or not to preload the image
  @param {string} [sizes] - The sizes attribute for the image tag

  @example
  {% render 'media' %}
{%- endcomment %}

{%- liquid
  assign preload = preload | default: false
  assign sizes = sizes | default: '(min-width: 64em) 30vw, (min-width: 48em) 25vw, 90vw'

  assign loading = 'lazy'
  assign fetchpriority = 'auto'
  if preload
    assign loading = 'eager'
    assign fetchpriority = 'high'
  endif
-%}

<div class="media">
  {%- case media.media_type -%}
    {%- when 'image' -%}
      {{-
        media
        | image_url: width: media.preview_image.width
        | image_tag:
          loading: loading,
          fetchpriority: fetchpriority,
          sizes: sizes,
          widths: '180, 360, 540, 720, 900, 1080, 1296, 1512, 1728, 2048',
          class: 'media__image'
      -}}

    {%- # TODO: handle other media types -%}
  {%- endcase -%}
</div>
